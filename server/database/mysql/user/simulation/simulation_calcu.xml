<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="simulation_test">

    <select id="getRebalencingDate">
            SELECT * FROM tm_date_manage
            WHERE gubun = #{rebalance_gubun}
            AND F12506 BETWEEN #{start_date} AND DATE_FORMAT(NOW(), '%Y%m%d')
    </select>


    <select id="getitemhisotry">
            SELECT td_kspjong_basic.F16012, td_kspjong_hist.* 
            FROM td_kspjong_basic
            INNER JOIN td_kspjong_hist
            ON td_kspjong_basic.F16013 = td_kspjong_hist.F16013
            WHERE td_kspjong_basic.F16012 IN (
            <foreach    collection="portfolio"   item="item"    index="index"   separator=" ," >
                                    #{item.code}  COLLATE utf8_general_ci
            </foreach>
            )
            ORDER BY F12506 ASC
    </select>
</mapper>